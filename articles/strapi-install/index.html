<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><style>:root{--accent-color:#FF4D4D}</style><title>Strapi - установка и настройка</title>
<meta name=description content="Lead developer"><meta name=keywords content='ладыгин сергей,Strapi'><meta property="og:url" content="https://updev.ru/articles/strapi-install/"><meta property="og:type" content="website"><meta property="og:title" content="Strapi - установка и настройка"><meta property="og:description" content="Lead developer"><meta property="og:image" content="/images/avatar.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="Strapi - установка и настройка"><meta name=twitter:description content="Lead developer"><meta property="twitter:domain" content="https://updev.ru/articles/strapi-install/"><meta property="twitter:url" content="https://updev.ru/articles/strapi-install/"><meta name=twitter:image content="/images/avatar.jpg"><link rel=canonical href=https://updev.ru/articles/strapi-install/><link rel=stylesheet type=text/css href=https://updev.ru//css/normalize.min.css media=print onload='this.media="all"'><link rel=stylesheet type=text/css href=https://updev.ru//css/main.css><link disabled id=dark-theme rel=stylesheet href=https://updev.ru//css/dark.css><script src=https://updev.ru//js/svg-injector.min.js></script><script src=https://updev.ru//js/feather-icons.min.js></script><script src=https://updev.ru//js/main.js></script><link rel=stylesheet type=text/css href=/css/base.css><script type=text/javascript>(function(e,t,n,s,o,i,a){e[o]=e[o]||function(){(e[o].a=e[o].a||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","https://mc.yandex.ru/metrika/tag.js","ym"),ym(89940266,"init",{clickmap:!0,trackLinks:!0,accurateTrackBounce:!0})</script><noscript><div><img src=https://mc.yandex.ru/watch/89940266 style=position:absolute;left:-9999px alt></div></noscript></head><body><script type=text/javascript>setThemeByUserPref()</script><header class=header><nav class=header-nav><div class=avatar><a href=https://updev.ru/><img src=https://updev.ru//images/avatar.jpg alt=avatar></a></div><div class=nav-title><a class=nav-brand href=https://updev.ru/>Ладыгин Сергей</a></div><div class=nav-links><div class=nav-link><a href=https://updev.ru/projects/>Проекты</a></div><div class=nav-link><a href=https://updev.ru/articles/>Статьи</a></div><div class=nav-link><a href=https://updev.ru/radar/>Тех. радар</a></div><div class=nav-link><a href=https://github.com/updevru><span data-feather=github></span></a></div><div class=nav-link><a href=https://t.me/updevru><span data-feather=send></span></a></div><div class=nav-link><a href=https://updev.ru/index.xml><span data-feather=rss></span></a></div><span class=nav-icons-divider></span><div class="nav-link dark-theme-toggle"><a><span id=theme-toggle-icon data-feather=moon></span></a></div><div class=nav-link id=hamburger-menu-toggle><a><span data-feather=menu></span></a></div><ul class="nav-hamburger-list visibility-hidden"><li class=nav-item><a href=https://updev.ru/projects/>Проекты</a></li><li class=nav-item><a href=https://updev.ru/articles/>Статьи</a></li><li class=nav-item><a href=https://updev.ru/radar/>Тех. радар</a></li><li class=nav-item><a href=https://github.com/updevru><span data-feather=github></span></a></li><li class=nav-item><a href=https://t.me/updevru><span data-feather=send></span></a></li><li class=nav-item><a href=https://updev.ru/index.xml><span data-feather=rss></span></a></li><li class="nav-item dark-theme-toggle"><a><span id=theme-toggle-icon data-feather=moon></span></a></li></ul></div></nav></header><main id=content class=page-type-post><div class="post container"><div class=post-header-section><h1>Strapi - установка и настройка</h1><small role=doc-subtitle></small><p class=post-date>апреля 25, 2024</p><ul class=post-tags><li class=post-tag><a href=https://updev.ru/tags/strapi>Strapi</a></li></ul></div><div class=post-content><p><p><a href=https://strapi.io/>Strapi</a> - популярная open-source headless CMS.
Написана на JavaScript/TypeScript, максимально настраивается под ваши задачи.</p><p>Данная CMS создана для разработчиков, она делает множество рутинной работы, позволяя сосредоточится на бизнес логике.
Подходит для широкого спектра задач - блоги, порталы, каталоги, сервисы, магазины и многое другое.</p><h2 id=создание-проекта>Создание проекта</h2><p>Исчерпывающая инструкция на <a href=https://docs.strapi.io/dev-docs/installation/cli>официальном сайте</a>,
тут я приведу краткий набор команд и действия. Демо приложение будет находиться в папке strapi.</p><p>Перед установкой у вас должно быть:</p><ul><li>Node.js версия v18 или v20</li><li>npm или yarn</li><li>Python</li></ul><p>Создание проекта:</p><pre tabindex=0><code>npx create-strapi-app@latest strapi
</code></pre><p>После выполнения запускаем в режиме разработки и создаем наш набор данных.</p><pre tabindex=0><code>npm run develop
</code></pre><p>Для локальной разработки этого, как правило, достаточно.</p><h2 id=конфигурация-и-сборка-проекта>Конфигурация и сборка проекта</h2><p>После установки и создание структуры данных для запуска проекта на сервере мы будем использовать Docker.
Это очень универсальный способ, который позволит запустить наше приложение как в облаке, так и на сервере.</p><p>Убедитесь что у вас установлен <a href=https://www.docker.com/>Docker</a> и <a href=https://docs.docker.com/compose/>Docker Compose</a>.</p><p>Добавляем Dockerfile в наш проект с содержимым:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-dockerfile data-lang=dockerfile><span style=display:flex><span><span style=color:#66d9ef>FROM</span><span style=color:#e6db74> node:20-alpine as build</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#75715e># Installing libvips-dev for sharp Compatibility</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>RUN</span> apk update <span style=color:#f92672>&amp;&amp;</span> apk add build-base gcc autoconf automake zlib-dev libpng-dev vips-dev <span style=color:#f92672>&amp;&amp;</span> rm -rf /var/cache/apk/* &gt; /dev/null 2&gt;&amp;<span style=color:#ae81ff>1</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>ARG</span> NODE_ENV<span style=color:#f92672>=</span>production
</span></span><span style=display:flex><span><span style=color:#66d9ef>ENV</span> NODE_ENV<span style=color:#f92672>=</span><span style=color:#e6db74>${</span>NODE_ENV<span style=color:#e6db74>}</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>WORKDIR</span><span style=color:#e6db74> /opt/app</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>COPY</span> package.json .<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>COPY</span> package-lock.json .<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>RUN</span> npm install --force<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>COPY</span> ./ .<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>RUN</span> npm run build<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>FROM</span><span style=color:#e6db74> node:20-alpine</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#75715e># Installing libvips-dev for sharp Compatibility</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>RUN</span> apk add vips-dev<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>RUN</span> rm -rf /var/cache/apk/*<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>ARG</span> NODE_ENV<span style=color:#f92672>=</span>production
</span></span><span style=display:flex><span><span style=color:#66d9ef>ENV</span> NODE_ENV<span style=color:#f92672>=</span><span style=color:#e6db74>${</span>NODE_ENV<span style=color:#e6db74>}</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>WORKDIR</span><span style=color:#e6db74> /opt/app</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>COPY</span> --from<span style=color:#f92672>=</span>build /opt/app ./<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>EXPOSE</span><span style=color:#e6db74> 1337</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>CMD</span> [<span style=color:#e6db74>&#34;npm&#34;</span>, <span style=color:#e6db74>&#34;run&#34;</span>,<span style=color:#e6db74>&#34;start&#34;</span>]<span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><p>Переходим в папку <code>strapi</code> с проектом и проверяем что сборка работает.</p><pre tabindex=0><code>docker build -t strapi .
</code></pre><p>Запускаем контейнер, для запуска потребуется указать реквизиты сервера базы данных.
Ниже команда для примера, необходимо указать свои.</p><pre tabindex=0><code>docker run -p 1337:1337 \ 
    -e DATABASE_CLIENT=postgres \ 
    -e DATABASE_HOST=127.0.0.1 \
    -e DATABASE_PORT=5432 \
    -e DATABASE_NAME=strapi \ 
    -e DATABASE_USERNAME=strapi \ 
    -e DATABASE_PASSWORD=strapi \
    strapi
</code></pre><h2 id=публикация-docker-образа>Публикация Docker образа</h2><p>Для запуска контейнера из нашего образа на удаленном сервере - необходимо загрузить образ в registry.</p><h3 id=docker-hub>Docker Hub</h3><p>Публичные образы можно загружать туда бесплатно, а для приватных нужна платная подписка.</p><p>Необходимо <a href=https://docs.docker.com/docker-hub/quickstart/>создать аккаунт</a>,
если у вас его еще нет, и <a href=https://docs.docker.com/reference/cli/docker/login/>авторизоваться под ним</a>.</p><p>После этого можно собрать образ и загрузить в реестр. Название образа обязательно должно в формате <code>логин/название:версия</code>.</p><pre tabindex=0><code>docker build -t updev/strapi:1.0 .
docker push updev/strapi:1.0
</code></pre><h3 id=yandex-container-registry>Yandex Container Registry</h3><p>Реестр Яндекса платный, но стоимость достаточно низкая и зависит от размера хранящихся там образов.</p><p>Инструкция как создать реестр и авторизоваться <a href=https://yandex.cloud/ru/docs/container-registry/quickstart/>тут</a>.
После создания у вас будет реестр с уникальным именем, например cr.yandex/crpoe5&mldr;..8h9al8r0/strapi</p><pre tabindex=0><code>docker build -t cr.yandex/crpoe5.....8h9al8r0/strapi:1.0 .
docker push cr.yandex/crpoe5.....8h9al8r0/strapi:1.0
</code></pre><p>Исходный код руководства на <a href=https://github.com/updevru/tutorial-strapi-deploy>GitHub</a>.</p></p></div></div><aside class=post-toc><nav id=toc><nav id=TableOfContents><ul><li><ul><li><a href=#создание-проекта>Создание проекта</a></li><li><a href=#конфигурация-и-сборка-проекта>Конфигурация и сборка проекта</a></li><li><a href=#публикация-docker-образа>Публикация Docker образа</a><ul><li><a href=#docker-hub>Docker Hub</a></li><li><a href=#yandex-container-registry>Yandex Container Registry</a></li></ul></li></ul></li></ul></nav></nav></aside></main><footer class=footer><span>&copy; 2024 Ладыгин Сергей</span>
<span>Made with &#10084;&#65039; using <a target=_blank href=https://github.com/526avijitgupta/gokarna>Gokarna</a></span></footer></body></html>